# 日志规范

规范英文名：HiveNet Log Standards

规范中文名：HiveNet 日志规范

**HiveNet标识名：hivenet_log_standards**

**HiveNet版本：v1.0.0**



## 文件存放路径

同一个应用的日志文件应统一路径存放，不应存放到多个路径下，路径命名统一为小写，用下划线"_"区分词组。日志根目录统一命名为：

- log/    -   日志目录
- log\_bak\_yyyy\[mm\]\[dd\]/   -  备份目录，根据需要可以按年/月/日进行备份

日志文件可以直接放在日志根目录下，但如果类型太多（需要按应用、模块区分），则可增加一层路径区分不同应用模块日志，路径格式如下：

- log/app[_module]    -   根据需要区分到应用还是模块

此外，基于存储划分的考虑，可以将日志根目录放置在应用部署路径下，或存在服务器的根目录下，采用何种方式根据实际需要选用：

- 在应用部署路径存放 - 必须直接放在部署路径根目录下，例如/weblogic/hive_net/log/...
- 在服务器根路径存放 - 例如 /log/...



## 文件命名

日志文件的命名规则为（均为小写）：app\[\_moudle\]\[\_info/debug/...\]\_yyyymmdd.log\[.n\]

app ： 应用名

moudle  :  模块名，可选

info/debug/...  :  日志级别，可选；当需要将不同级别的的日志内容区分开时选用

yyyymmdd  ：  日志日期

.n  :  日志序号，如果控制了日志文件的最大大小，则在文件超过限额时自动增加序号，并开始写下一个日志



## 日志输出规范

日志输出信息格式固定为 "日志头+日志信息"，"日志头"的所有信息均在日志开始行中，"日志信息"可以在日志头同一行中全部输出，也可以分多行输出。

### 标准格式

日志头为规则的字符串格式，每个信息项用中括号"\[\]"标注起来，日志头的前2个为固定顺序的信息项，包括：

\[%(asctime)s\]  :  日志记录时间，格式为"yyyy-mm-dd hh:mi:ss,ms"，例如[2018-09-09 13:58:08,243]

[%(levelname)s\] : 日志级别名称，例如\[DEBUG\]、\[INFO\]、\[WARNING\]、\[ERROR\]、\[CRITICAL\]



后面的日志头信息项为不固定信息项，格式为 \[信息项标识:信息项值\] ，常用的信息项标识包括：

PID : 进程ID， 例如 \[PID:4348]

TID : 线程ID, 例如 \[TID:3676]

TNAME: 线程名称，例如 \[TNAME:Service_Recv]

PATH : 执行文件路径，例如 \[PATH:/hivenet/]

FILE : 执行文件名，例如 \[FILE:simple_log_demo.py]

FUN :  函数名，例如 \[FUN:test_case2]

TRACE : 调用关系追踪ID

USE : 耗时，单位为秒，例如 \[USE:30.345s]



日志信息为具体输出的详细信息，没有具体格式要求，可以一行也可以多行，如存在格式化的数据需要分析，建议抽离为日志头信息处理，采用手段为将信息项按照日志头格式标注并放在日志信息开始位置传入日志处理。



示例如下：

```
[2018-09-09 14:46:27,847][INFO][PID:4328][TID:4776][FILE:simple_log_demo.py][FUN:test_case2]test_case2:write_log:INFO:6-1:界面应显示本日志
，文件应显示本日志
[2018-09-09 14:46:27,848][DEBUG][PID:4328][TID:4776][FILE:simple_log_demo.py][FUN:test_case2]test_case2:write_log:DEBUG:6-1:界面应显示本日
志，文件应显示本日志
[2018-09-09 14:46:27,848][INFO][PID:4328][TID:4776][FILE:simple_log_demo.py][FUN:test_case2]test_case2:write_log:INFO:7-1:界面应显示本日志
，文件应显示本日志
```



### 函数调用链日志规范

函数调用链日志为1行，通用格式为：

\[%(asctime)s\][%(levelname)s\]\[PID:]\[TID:3676]\[FILE:\]\[FUN:\]\[TRACE:\]

开始调用日志：